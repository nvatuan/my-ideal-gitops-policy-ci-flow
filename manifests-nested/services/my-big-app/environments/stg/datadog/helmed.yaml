---
# Source: datadog/charts/operator/templates/service_account.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: datadog-operator
  namespace: default
  labels:
    app.kubernetes.io/name: operator
    helm.sh/chart: operator-2.17.0-dev.2
    app.kubernetes.io/instance: datadog
    app.kubernetes.io/version: "1.22.0-rc.1"
    app.kubernetes.io/managed-by: Helm
---
# Source: datadog/templates/cluster-agent-rbac.yaml
apiVersion: v1
kind: ServiceAccount
automountServiceAccountToken: true
metadata:
  labels:
    app: "datadog"
    chart: "datadog-3.160.2"
    heritage: "Helm"
    release: "datadog"
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: datadog-cluster-agent
  namespace: default
---
# Source: datadog/templates/rbac.yaml
apiVersion: v1
kind: ServiceAccount
automountServiceAccountToken: true
metadata:
  name: datadog
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7" # end range $role := .Values.datadog.secretBackend.roles
---
# Source: datadog/templates/secret-api-key.yaml
apiVersion: v1
kind: Secret
metadata:
  name: datadog
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
type: Opaque
data:
  api-key: "TUlTU0lORw=="
---
# Source: datadog/templates/secret-cluster-agent-token.yaml
apiVersion: v1
kind: Secret
metadata:
  name: datadog-cluster-agent
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
type: Opaque
data:
  token: "bmdPMTM4VUtKYlNXMGlBQkQyWlRwS0ZUekNHZjdMbVo="
---
# Source: datadog/templates/cluster-agent-confd-configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: datadog-cluster-agent-confd
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  annotations:
    checksum/confd-config: 44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a
data:
  kubernetes_state_core.yaml.default: |-
    init_config:
    instances:
      - collectors:
        - secrets
        - configmaps
        - nodes
        - pods
        - services
        - resourcequotas
        - replicationcontrollers
        - limitranges
        - persistentvolumeclaims
        - persistentvolumes
        - namespaces
        - endpoints
        - daemonsets
        - deployments
        - replicasets
        - statefulsets
        - controllerrevisions
        - cronjobs
        - jobs
        - horizontalpodautoscalers
        - poddisruptionbudgets
        - storageclasses
        - volumeattachments
        - ingresses
        labels_as_tags:
          {}
        annotations_as_tags:
          {}
  
  kubernetes_apiserver.yaml: |-
    init_config:
    instances:
      -
        filtering_enabled: false
        unbundle_events: false
---
# Source: datadog/templates/datadog-endpoint-configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: datadog-endpoint-config
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
data:
  api-key-secret-name: "datadog"
---
# Source: datadog/templates/install_info-configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: datadog-installinfo
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  annotations:
    checksum/install_info: 470cf9cc66fc300566fbe7949760d8e8ad4a1de4a0c12403c9696124e68f96df
data:
  install_info: |
    ---
    install_method:
      tool: helm
      tool_version: Helm
      installer_version: datadog-3.160.2
---
# Source: datadog/templates/kpi-telemetry-configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: datadog-kpi-telemetry-configmap
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
data:
  install_type: k8s_manual
  install_id: "8d9f54e0-6fec-41db-a676-15856112f45a"
  install_time: "1768397887"
---
# Source: datadog/charts/operator/charts/datadogCRDs/templates/datadoghq.com_datadogdashboards_v1.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.3
  name: datadogdashboards.datadoghq.com
  labels:
    helm.sh/chart: 'datadogCRDs-2.15.0-dev.1'
    app.kubernetes.io/managed-by: 'Helm'
    app.kubernetes.io/name: 'datadogCRDs'
    app.kubernetes.io/instance: 'datadog'
spec:
  group: datadoghq.com
  names:
    kind: DatadogDashboard
    listKind: DatadogDashboardList
    plural: datadogdashboards
    shortNames:
      - ddd
    singular: datadogdashboard
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .status.id
          name: id
          type: string
        - jsonPath: .status.syncStatus
          name: sync status
          type: string
        - jsonPath: .metadata.creationTimestamp
          name: age
          type: date
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: DatadogDashboard is the Schema for the datadogdashboards API
          properties:
            apiVersion:
              description: |-
                APIVersion defines the versioned schema of this representation of an object.
                Servers should convert recognized schemas to the latest internal value, and
                may reject unrecognized values.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
              type: string
            kind:
              description: |-
                Kind is a string value representing the REST resource this object represents.
                Servers may infer this from the endpoint the client submits requests to.
                Cannot be updated.
                In CamelCase.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
              type: string
            metadata:
              type: object
            spec:
              description: DatadogDashboardSpec defines the desired state of DatadogDashboard
              properties:
                description:
                  description: Description is the description of the dashboard.
                  type: string
                layoutType:
                  description: LayoutType is the layout type of the dashboard.
                  enum:
                    - ordered
                    - free
                  type: string
                notifyList:
                  description: NotifyList is the list of handles of users to notify when changes are made to this dashboard.
                  items:
                    type: string
                  type: array
                  x-kubernetes-list-type: set
                reflowType:
                  description: |-
                    Reflowtype is the reflow type for a 'new dashboard layout' dashboard. Set this only when layout type is 'ordered'.
                    If set to 'fixed', the dashboard expects all widgets to have a layout, and if it's set to 'auto',
                    widgets should not have layouts.
                  type: string
                tags:
                  description: Tags is a list of team names representing ownership of a dashboard.
                  items:
                    type: string
                  type: array
                  x-kubernetes-list-type: set
                templateVariablePresets:
                  description: TemplateVariablePresets is an array of template variables saved views.
                  items:
                    description: DashboardTemplateVariablePreset Template variables saved views.
                    properties:
                      name:
                        description: The name of the variable.
                        type: string
                      templateVariables:
                        description: List of variables.
                        items:
                          description: DashboardTemplateVariablePresetValue Template variables saved views.
                          properties:
                            name:
                              description: The name of the variable.
                              type: string
                            values:
                              description: One or many template variable values within the saved view, which will be unioned together using `OR` if more than one is specified. Cannot be used in conjunction with `value`.
                              items:
                                type: string
                              type: array
                              x-kubernetes-list-type: set
                          required:
                            - name
                          type: object
                        type: array
                        x-kubernetes-list-map-keys:
                          - name
                        x-kubernetes-list-type: map
                    required:
                      - name
                    type: object
                  type: array
                  x-kubernetes-list-map-keys:
                    - name
                  x-kubernetes-list-type: map
                templateVariables:
                  description: TemplateVariables is a list of template variables for this dashboard.
                  items:
                    description: DashboardTemplateVariable Template variable.
                    properties:
                      availableValues:
                        description: The list of values that the template variable drop-down is limited to.
                        items:
                          type: string
                        type: array
                      defaults:
                        description: One or many default values for template variables on load. If more than one default is specified, they will be unioned together with `OR`. Cannot be used in conjunction with `default`.
                        items:
                          type: string
                        type: array
                        x-kubernetes-list-type: set
                      name:
                        description: The name of the variable.
                        type: string
                      prefix:
                        description: The tag prefix associated with the variable. Only tags with this prefix appear in the variable drop-down.
                        type: string
                    required:
                      - name
                    type: object
                  type: array
                  x-kubernetes-list-map-keys:
                    - name
                  x-kubernetes-list-type: map
                title:
                  description: Title is the title of the dashboard.
                  minLength: 1
                  type: string
                widgets:
                  description: Widgets is a JSON string representation of a list of Datadog API Widgets
                  type: string
              required:
                - layoutType
                - title
              type: object
            status:
              description: DatadogDashboardStatus defines the observed state of DatadogDashboard
              properties:
                conditions:
                  description: Conditions represents the latest available observations of the state of a DatadogDashboard.
                  items:
                    description: Condition contains details for one aspect of the current state of this API Resource.
                    properties:
                      lastTransitionTime:
                        description: |-
                          lastTransitionTime is the last time the condition transitioned from one status to another.
                          This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                        format: date-time
                        type: string
                      message:
                        description: |-
                          message is a human readable message indicating details about the transition.
                          This may be an empty string.
                        maxLength: 32768
                        type: string
                      observedGeneration:
                        description: |-
                          observedGeneration represents the .metadata.generation that the condition was set based upon.
                          For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                          with respect to the current state of the instance.
                        format: int64
                        minimum: 0
                        type: integer
                      reason:
                        description: |-
                          reason contains a programmatic identifier indicating the reason for the condition's last transition.
                          Producers of specific condition types may define expected values and meanings for this field,
                          and whether the values are considered a guaranteed API.
                          The value should be a CamelCase string.
                          This field may not be empty.
                        maxLength: 1024
                        minLength: 1
                        pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                        type: string
                      status:
                        description: status of the condition, one of True, False, Unknown.
                        enum:
                          - "True"
                          - "False"
                          - Unknown
                        type: string
                      type:
                        description: type of condition in CamelCase or in foo.example.com/CamelCase.
                        maxLength: 316
                        pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                        type: string
                    required:
                      - lastTransitionTime
                      - message
                      - reason
                      - status
                      - type
                    type: object
                  type: array
                  x-kubernetes-list-map-keys:
                    - type
                  x-kubernetes-list-type: map
                created:
                  description: Created is the time the dashboard was created.
                  format: date-time
                  type: string
                creator:
                  description: Creator is the identity of the dashboard creator.
                  type: string
                currentHash:
                  description: |-
                    CurrentHash tracks the hash of the current DatadogDashboardSpec to know
                    if the Spec has changed and needs an update.
                  type: string
                id:
                  description: ID is the dashboard ID generated in Datadog.
                  type: string
                lastForceSyncTime:
                  description: LastForceSyncTime is the last time the API dashboard was last force synced with the DatadogDashboard resource
                  format: date-time
                  type: string
                syncStatus:
                  description: SyncStatus shows the health of syncing the dashboard state to Datadog.
                  type: string
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
# Source: datadog/charts/operator/charts/datadogCRDs/templates/datadoghq.com_datadoggenericresources_v1.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.3
  name: datadoggenericresources.datadoghq.com
  labels:
    helm.sh/chart: 'datadogCRDs-2.15.0-dev.1'
    app.kubernetes.io/managed-by: 'Helm'
    app.kubernetes.io/name: 'datadogCRDs'
    app.kubernetes.io/instance: 'datadog'
spec:
  group: datadoghq.com
  names:
    kind: DatadogGenericResource
    listKind: DatadogGenericResourceList
    plural: datadoggenericresources
    shortNames:
      - ddgr
    singular: datadoggenericresource
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .status.id
          name: id
          type: string
        - jsonPath: .status.syncStatus
          name: sync status
          type: string
        - jsonPath: .metadata.creationTimestamp
          name: age
          type: date
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: DatadogGenericResource is the Schema for the DatadogGenericResources API
          properties:
            apiVersion:
              description: |-
                APIVersion defines the versioned schema of this representation of an object.
                Servers should convert recognized schemas to the latest internal value, and
                may reject unrecognized values.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
              type: string
            kind:
              description: |-
                Kind is a string value representing the REST resource this object represents.
                Servers may infer this from the endpoint the client submits requests to.
                Cannot be updated.
                In CamelCase.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
              type: string
            metadata:
              type: object
            spec:
              description: DatadogGenericResourceSpec defines the desired state of DatadogGenericResource
              properties:
                jsonSpec:
                  description: JsonSpec is the specification of the API object
                  type: string
                type:
                  description: Type is the type of the API object
                  enum:
                    - downtime
                    - monitor
                    - notebook
                    - synthetics_api_test
                    - synthetics_browser_test
                  type: string
              required:
                - jsonSpec
                - type
              type: object
            status:
              description: DatadogGenericResourceStatus defines the observed state of DatadogGenericResource
              properties:
                conditions:
                  description: Conditions represents the latest available observations of the state of a DatadogGenericResource.
                  items:
                    description: Condition contains details for one aspect of the current state of this API Resource.
                    properties:
                      lastTransitionTime:
                        description: |-
                          lastTransitionTime is the last time the condition transitioned from one status to another.
                          This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                        format: date-time
                        type: string
                      message:
                        description: |-
                          message is a human readable message indicating details about the transition.
                          This may be an empty string.
                        maxLength: 32768
                        type: string
                      observedGeneration:
                        description: |-
                          observedGeneration represents the .metadata.generation that the condition was set based upon.
                          For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                          with respect to the current state of the instance.
                        format: int64
                        minimum: 0
                        type: integer
                      reason:
                        description: |-
                          reason contains a programmatic identifier indicating the reason for the condition's last transition.
                          Producers of specific condition types may define expected values and meanings for this field,
                          and whether the values are considered a guaranteed API.
                          The value should be a CamelCase string.
                          This field may not be empty.
                        maxLength: 1024
                        minLength: 1
                        pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                        type: string
                      status:
                        description: status of the condition, one of True, False, Unknown.
                        enum:
                          - "True"
                          - "False"
                          - Unknown
                        type: string
                      type:
                        description: type of condition in CamelCase or in foo.example.com/CamelCase.
                        maxLength: 316
                        pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                        type: string
                    required:
                      - lastTransitionTime
                      - message
                      - reason
                      - status
                      - type
                    type: object
                  type: array
                  x-kubernetes-list-map-keys:
                    - type
                  x-kubernetes-list-type: map
                created:
                  description: Created is the time the object was created.
                  format: date-time
                  type: string
                creator:
                  description: Creator is the identity of the creator.
                  type: string
                currentHash:
                  description: |-
                    CurrentHash tracks the hash of the current DatadogGenericResourceSpec to know
                    if the JsonSpec has changed and needs an update.
                  type: string
                id:
                  description: Id is the object unique identifier generated in Datadog.
                  type: string
                lastForceSyncTime:
                  description: LastForceSyncTime is the last time the API object was last force synced with the custom resource
                  format: date-time
                  type: string
                syncStatus:
                  description: SyncStatus shows the health of syncing the object state to Datadog.
                  type: string
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
# Source: datadog/charts/operator/charts/datadogCRDs/templates/datadoghq.com_datadogmonitors_v1.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.3
  name: datadogmonitors.datadoghq.com
  labels:
    helm.sh/chart: 'datadogCRDs-2.15.0-dev.1'
    app.kubernetes.io/managed-by: 'Helm'
    app.kubernetes.io/name: 'datadogCRDs'
    app.kubernetes.io/instance: 'datadog'
spec:
  group: datadoghq.com
  names:
    kind: DatadogMonitor
    listKind: DatadogMonitorList
    plural: datadogmonitors
    singular: datadogmonitor
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .status.id
          name: id
          type: string
        - jsonPath: .status.monitorState
          name: monitor state
          type: string
        - jsonPath: .status.monitorStateLastTransitionTime
          name: last state transition
          type: string
        - format: date
          jsonPath: .status.monitorStateLastUpdateTime
          name: last state sync
          type: string
        - jsonPath: .status.syncStatus
          name: sync status
          type: string
        - jsonPath: .metadata.creationTimestamp
          name: age
          type: date
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: DatadogMonitor allows to define and manage Monitors from your Kubernetes Cluster
          properties:
            apiVersion:
              description: |-
                APIVersion defines the versioned schema of this representation of an object.
                Servers should convert recognized schemas to the latest internal value, and
                may reject unrecognized values.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
              type: string
            kind:
              description: |-
                Kind is a string value representing the REST resource this object represents.
                Servers may infer this from the endpoint the client submits requests to.
                Cannot be updated.
                In CamelCase.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
              type: string
            metadata:
              type: object
            spec:
              description: DatadogMonitorSpec defines the desired state of DatadogMonitor
              properties:
                controllerOptions:
                  description: ControllerOptions are the optional parameters in the DatadogMonitor controller
                  properties:
                    disableRequiredTags:
                      description: DisableRequiredTags disables the automatic addition of required tags to monitors.
                      type: boolean
                  type: object
                message:
                  description: Message is a message to include with notifications for this monitor
                  minLength: 1
                  type: string
                name:
                  description: Name is the monitor name
                  minLength: 1
                  type: string
                options:
                  description: Options are the optional parameters associated with your monitor
                  properties:
                    enableLogsSample:
                      description: A Boolean indicating whether to send a log sample when the log monitor triggers.
                      type: boolean
                    escalationMessage:
                      description: A message to include with a re-notification.
                      type: string
                    evaluationDelay:
                      description: |-
                        Time (in seconds) to delay evaluation, as a non-negative integer. For example, if the value is set to 300 (5min),
                        the timeframe is set to last_5m and the time is 7:00, the monitor evaluates data from 6:50 to 6:55.
                        This is useful for AWS CloudWatch and other backfilled metrics to ensure the monitor always has data during evaluation.
                      format: int64
                      type: integer
                    groupRetentionDuration:
                      description: |-
                        The time span after which groups with missing data are dropped from the monitor state.
                        The minimum value is one hour, and the maximum value is 72 hours.
                        Example values are: "60m", "1h", and "2d".
                        This option is only available for APM Trace Analytics, Audit Trail, CI, Error Tracking, Event, Logs, and RUM monitors.
                      type: string
                    groupbySimpleMonitor:
                      description: A Boolean indicating whether the log alert monitor triggers a single alert or multiple alerts when any group breaches a threshold.
                      type: boolean
                    includeTags:
                      description: A Boolean indicating whether notifications from this monitor automatically inserts its triggering tags into the title.
                      type: boolean
                    locked:
                      description: 'DEPRECATED: Whether or not the monitor is locked (only editable by creator and admins). Use `restricted_roles` instead.'
                      type: boolean
                    newGroupDelay:
                      description: |-
                        Time (in seconds) to allow a host to boot and applications to fully start before starting the evaluation of
                        monitor results. Should be a non negative integer.
                      format: int64
                      type: integer
                    noDataTimeframe:
                      description: |-
                        The number of minutes before a monitor notifies after data stops reporting. Datadog recommends at least 2x the
                        monitor timeframe for metric alerts or 2 minutes for service checks. If omitted, 2x the evaluation timeframe
                        is used for metric alerts, and 24 hours is used for service checks.
                      format: int64
                      type: integer
                    notificationPresetName:
                      description: An enum that toggles the display of additional content sent in the monitor notification.
                      type: string
                    notifyAudit:
                      description: A Boolean indicating whether tagged users are notified on changes to this monitor.
                      type: boolean
                    notifyBy:
                      description: |-
                        A string indicating the granularity a monitor alerts on. Only available for monitors with groupings.
                        For instance, a monitor grouped by cluster, namespace, and pod can be configured to only notify on each new
                        cluster violating the alert conditions by setting notify_by to ["cluster"]. Tags mentioned in notify_by must
                        be a subset of the grouping tags in the query. For example, a query grouped by cluster and namespace cannot
                        notify on region. Setting notify_by to [*] configures the monitor to notify as a simple-alert.
                      items:
                        type: string
                      type: array
                      x-kubernetes-list-type: set
                    notifyNoData:
                      description: A Boolean indicating whether this monitor notifies when data stops reporting.
                      type: boolean
                    onMissingData:
                      description: |-
                        An enum that controls how groups or monitors are treated if an evaluation does not return data points.
                        The default option results in different behavior depending on the monitor query type.
                        For monitors using Count queries, an empty monitor evaluation is treated as 0 and is compared to the threshold conditions.
                        For monitors using any query type other than Count, for example Gauge, Measure, or Rate, the monitor shows the last known status.
                        This option is only available for APM Trace Analytics, Audit Trail, CI, Error Tracking, Event, Logs, and RUM monitors
                      type: string
                    renotifyInterval:
                      description: |-
                        The number of minutes after the last notification before a monitor re-notifies on the current status.
                        It only re-notifies if it’s not resolved.
                      format: int64
                      type: integer
                    renotifyOccurrences:
                      description: The number of times re-notification messages should be sent on the current status at the provided re-notification interval.
                      format: int64
                      type: integer
                    renotifyStatuses:
                      description: The types of statuses for which re-notification messages should be sent. Valid values are alert, warn, no data.
                      items:
                        description: MonitorRenotifyStatusType The different statuses for which renotification is supported.
                        type: string
                      type: array
                      x-kubernetes-list-type: set
                    requireFullWindow:
                      description: |-
                        A Boolean indicating whether this monitor needs a full window of data before it’s evaluated. We highly
                        recommend you set this to false for sparse metrics, otherwise some evaluations are skipped. Default is false.
                      type: boolean
                    schedulingOptions:
                      description: Configuration options for scheduling.
                      properties:
                        customSchedule:
                          description: Configuration options for the custom schedule. If start is omitted, the monitor creation time will be used.
                          properties:
                            recurrence:
                              description: DatadogMonitorOptionsSchedulingOptionsCustomScheduleRecurrence is a struct of the recurrence definition
                              properties:
                                rrule:
                                  description: The recurrence rule in iCalendar format. For example, `FREQ=MONTHLY;BYMONTHDAY=28,29,30,31;BYSETPOS=-1`.
                                  type: string
                                start:
                                  description: |-
                                    The start date of the recurrence rule defined in `YYYY-MM-DDThh:mm:ss` format.
                                    If omitted, the monitor creation time will be used.
                                  type: string
                                timezone:
                                  description: The timezone in `tz database` format, in which the recurrence rule is defined. For example, `America/New_York` or `UTC`.
                                  type: string
                              type: object
                          type: object
                        evaluationWindow:
                          description: |-
                            Configuration options for the evaluation window. If hour_starts is set, no other fields may be set.
                            Otherwise, day_starts and month_starts must be set together.
                          properties:
                            dayStarts:
                              description: The time of the day at which a one day cumulative evaluation window starts. Must be defined in UTC time in HH:mm format.
                              type: string
                            hourStarts:
                              description: The minute of the hour at which a one hour cumulative evaluation window starts.
                              format: int32
                              type: integer
                            monthStarts:
                              description: The day of the month at which a one month cumulative evaluation window starts.
                              format: int32
                              type: integer
                          type: object
                      type: object
                    thresholdWindows:
                      description: A struct of the alerting time window options.
                      properties:
                        recoveryWindow:
                          description: Describes how long an anomalous metric must be normal before the alert recovers.
                          type: string
                        triggerWindow:
                          description: Describes how long a metric must be anomalous before an alert triggers.
                          type: string
                      type: object
                    thresholds:
                      description: A struct of the different monitor threshold values.
                      properties:
                        critical:
                          description: The monitor CRITICAL threshold.
                          type: string
                        criticalRecovery:
                          description: The monitor CRITICAL recovery threshold.
                          type: string
                        ok:
                          description: The monitor OK threshold.
                          type: string
                        unknown:
                          description: The monitor UNKNOWN threshold.
                          type: string
                        warning:
                          description: The monitor WARNING threshold.
                          type: string
                        warningRecovery:
                          description: The monitor WARNING recovery threshold.
                          type: string
                      type: object
                    timeoutH:
                      description: The number of hours of the monitor not reporting data before it automatically resolves from a triggered state.
                      format: int64
                      type: integer
                  type: object
                priority:
                  description: Priority is an integer from 1 (high) to 5 (low) indicating alert severity
                  format: int64
                  type: integer
                query:
                  description: Query is the Datadog monitor query
                  minLength: 1
                  type: string
                restrictedRoles:
                  description: |-
                    RestrictedRoles is a list of unique role identifiers to define which roles are allowed to edit the monitor.
                    `restricted_roles` is the successor of `locked`. For more information about `locked` and `restricted_roles`,
                    see the [monitor options docs](https://docs.datadoghq.com/monitors/guide/monitor_api_options/#permissions-options).
                  items:
                    type: string
                  type: array
                  x-kubernetes-list-type: set
                tags:
                  description: Tags is the monitor tags associated with your monitor
                  items:
                    type: string
                  type: array
                  x-kubernetes-list-type: set
                type:
                  description: Type is the monitor type
                  enum:
                    - metric alert
                    - query alert
                    - service check
                    - event alert
                    - log alert
                    - process alert
                    - rum alert
                    - trace-analytics alert
                    - slo alert
                    - event-v2 alert
                    - audit alert
                    - composite
                  type: string
              required:
                - message
                - name
                - query
                - type
              type: object
            status:
              description: DatadogMonitorStatus defines the observed state of DatadogMonitor
              properties:
                conditions:
                  description: Conditions Represents the latest available observations of a DatadogMonitor's current state.
                  items:
                    description: DatadogMonitorCondition describes the current state of a DatadogMonitor
                    properties:
                      lastTransitionTime:
                        description: Last time the condition transitioned from one status to another.
                        format: date-time
                        type: string
                      lastUpdateTime:
                        description: Last time the condition was updated.
                        format: date-time
                        type: string
                      message:
                        description: A human readable message indicating details about the transition.
                        type: string
                      reason:
                        description: The reason for the condition's last transition.
                        type: string
                      status:
                        description: Status of the condition, one of True, False, Unknown.
                        type: string
                      type:
                        description: Type of DatadogMonitor condition
                        type: string
                    required:
                      - status
                      - type
                    type: object
                  type: array
                  x-kubernetes-list-map-keys:
                    - type
                  x-kubernetes-list-type: map
                created:
                  description: Created is the time the monitor was created
                  format: date-time
                  type: string
                creator:
                  description: Creator is the identify of the monitor creator
                  type: string
                currentHash:
                  description: |-
                    CurrentHash tracks the hash of the current DatadogMonitorSpec to know
                    if the Spec has changed and needs an update
                  type: string
                downtimeStatus:
                  description: DowntimeStatus defines whether the monitor is downtimed
                  properties:
                    downtimeID:
                      description: DowntimeID is the downtime ID.
                      type: integer
                    isDowntimed:
                      description: IsDowntimed shows the downtime status of the monitor.
                      type: boolean
                  type: object
                id:
                  description: ID is the monitor ID generated in Datadog
                  type: integer
                monitorLastForceSyncTime:
                  description: MonitorLastForceSyncTime is the last time the API monitor was last force synced with the DatadogMonitor resource
                  format: date-time
                  type: string
                monitorState:
                  description: MonitorState is the overall state of monitor
                  type: string
                monitorStateLastTransitionTime:
                  description: MonitorStateLastTransitionTime is the last time the monitor state changed
                  format: date-time
                  type: string
                monitorStateLastUpdateTime:
                  description: MonitorStateLastUpdateTime is the last time the monitor state updated
                  format: date-time
                  type: string
                monitorStateSyncStatus:
                  description: MonitorStateSyncStatus shows the health of syncing the monitor state to Datadog
                  type: string
                primary:
                  description: |-
                    Primary defines whether the monitor is managed by the Kubernetes custom
                    resource (true) or outside Kubernetes (false)
                  type: boolean
                triggeredState:
                  description: TriggeredState only includes details for monitor groups that are triggering
                  items:
                    description: |-
                      DatadogMonitorTriggeredState represents the details of a triggering DatadogMonitor
                      The DatadogMonitor is triggering if one of its groups is in Alert, Warn, or No Data
                    properties:
                      lastTransitionTime:
                        format: date-time
                        type: string
                      monitorGroup:
                        description: MonitorGroup is the name of the triggering group
                        type: string
                      state:
                        description: DatadogMonitorState represents the overall DatadogMonitor state
                        type: string
                    required:
                      - monitorGroup
                    type: object
                  type: array
                  x-kubernetes-list-map-keys:
                    - monitorGroup
                  x-kubernetes-list-type: map
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
# Source: datadog/charts/operator/charts/datadogCRDs/templates/datadoghq.com_datadogslos_v1.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.3
  name: datadogslos.datadoghq.com
  labels:
    helm.sh/chart: 'datadogCRDs-2.15.0-dev.1'
    app.kubernetes.io/managed-by: 'Helm'
    app.kubernetes.io/name: 'datadogCRDs'
    app.kubernetes.io/instance: 'datadog'
spec:
  group: datadoghq.com
  names:
    kind: DatadogSLO
    listKind: DatadogSLOList
    plural: datadogslos
    shortNames:
      - ddslo
    singular: datadogslo
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .status.id
          name: id
          type: string
        - jsonPath: .status.syncStatus
          name: sync status
          type: string
        - jsonPath: .metadata.creationTimestamp
          name: age
          type: date
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: DatadogSLO allows a user to define and manage datadog SLOs from Kubernetes cluster.
          properties:
            apiVersion:
              description: |-
                APIVersion defines the versioned schema of this representation of an object.
                Servers should convert recognized schemas to the latest internal value, and
                may reject unrecognized values.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
              type: string
            kind:
              description: |-
                Kind is a string value representing the REST resource this object represents.
                Servers may infer this from the endpoint the client submits requests to.
                Cannot be updated.
                In CamelCase.
                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
              type: string
            metadata:
              type: object
            spec:
              properties:
                controllerOptions:
                  description: ControllerOptions are the optional parameters in the DatadogSLO controller
                  properties:
                    disableRequiredTags:
                      description: DisableRequiredTags disables the automatic addition of required tags to SLOs.
                      type: boolean
                  type: object
                description:
                  description: |-
                    Description is a user-defined description of the service level objective.
                    Always included in service level objective responses (but may be null). Optional in create/update requests.
                  type: string
                groups:
                  description: |-
                    Groups is a list of (up to 100) monitor groups that narrow the scope of a monitor service level objective.
                    Included in service level objective responses if it is not empty.
                    Optional in create/update requests for monitor service level objectives, but may only be used when the length of the monitor_ids field is one.
                  items:
                    type: string
                  type: array
                  x-kubernetes-list-type: set
                monitorIDs:
                  description: MonitorIDs is a list of monitor IDs that defines the scope of a monitor service level objective. Required if type is monitor.
                  items:
                    format: int64
                    type: integer
                  type: array
                  x-kubernetes-list-type: set
                name:
                  description: Name is the name of the service level objective.
                  type: string
                query:
                  description: |-
                    Query is the query for a metric-based SLO. Required if type is metric.
                    Note that only the `sum by` aggregator is allowed, which sums all request counts. `Average`, `max`, nor `min` request aggregators are not supported.
                  properties:
                    denominator:
                      description: Denominator is a Datadog metric query for total (valid) events.
                      type: string
                    numerator:
                      description: Numerator is a Datadog metric query for good events.
                      type: string
                  required:
                    - denominator
                    - numerator
                  type: object
                tags:
                  description: |-
                    Tags is a list of tags to associate with your service level objective.
                    This can help you categorize and filter service level objectives in the service level objectives page of the UI.
                    Note: it's not currently possible to filter by these tags when querying via the API.
                  items:
                    type: string
                  type: array
                  x-kubernetes-list-type: set
                targetThreshold:
                  anyOf:
                    - type: integer
                    - type: string
                  description: TargetThreshold is the target threshold such that when the service level indicator is above this threshold over the given timeframe, the objective is being met.
                  pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                  x-kubernetes-int-or-string: true
                timeframe:
                  description: The SLO time window options.
                  type: string
                type:
                  description: Type is the type of the service level objective.
                  type: string
                warningThreshold:
                  anyOf:
                    - type: integer
                    - type: string
                  description: WarningThreshold is a optional warning threshold such that when the service level indicator is below this value for the given threshold, but above the target threshold, the objective appears in a "warning" state. This value must be greater than the target threshold.
                  pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                  x-kubernetes-int-or-string: true
              required:
                - name
                - targetThreshold
                - timeframe
                - type
              type: object
            status:
              description: DatadogSLOStatus defines the observed state of a DatadogSLO.
              properties:
                conditions:
                  description: Conditions represents the latest available observations of the state of a DatadogSLO.
                  items:
                    description: Condition contains details for one aspect of the current state of this API Resource.
                    properties:
                      lastTransitionTime:
                        description: |-
                          lastTransitionTime is the last time the condition transitioned from one status to another.
                          This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                        format: date-time
                        type: string
                      message:
                        description: |-
                          message is a human readable message indicating details about the transition.
                          This may be an empty string.
                        maxLength: 32768
                        type: string
                      observedGeneration:
                        description: |-
                          observedGeneration represents the .metadata.generation that the condition was set based upon.
                          For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                          with respect to the current state of the instance.
                        format: int64
                        minimum: 0
                        type: integer
                      reason:
                        description: |-
                          reason contains a programmatic identifier indicating the reason for the condition's last transition.
                          Producers of specific condition types may define expected values and meanings for this field,
                          and whether the values are considered a guaranteed API.
                          The value should be a CamelCase string.
                          This field may not be empty.
                        maxLength: 1024
                        minLength: 1
                        pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                        type: string
                      status:
                        description: status of the condition, one of True, False, Unknown.
                        enum:
                          - "True"
                          - "False"
                          - Unknown
                        type: string
                      type:
                        description: type of condition in CamelCase or in foo.example.com/CamelCase.
                        maxLength: 316
                        pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                        type: string
                    required:
                      - lastTransitionTime
                      - message
                      - reason
                      - status
                      - type
                    type: object
                  type: array
                  x-kubernetes-list-map-keys:
                    - type
                  x-kubernetes-list-type: map
                created:
                  description: Created is the time the SLO was created.
                  format: date-time
                  type: string
                creator:
                  description: Creator is the identity of the SLO creator.
                  type: string
                currentHash:
                  description: |-
                    CurrentHash tracks the hash of the current DatadogSLOSpec to know
                    if the Spec has changed and needs an update.
                  type: string
                id:
                  description: ID is the SLO ID generated in Datadog.
                  type: string
                lastForceSyncTime:
                  description: LastForceSyncTime is the last time the API SLO was last force synced with the DatadogSLO resource.
                  format: date-time
                  type: string
                syncStatus:
                  description: SyncStatus shows the health of syncing the SLO state to Datadog.
                  type: string
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
# Source: datadog/charts/operator/templates/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: datadog-operator
  labels:
    app.kubernetes.io/name: operator
    helm.sh/chart: operator-2.17.0-dev.2
    app.kubernetes.io/instance: datadog
    app.kubernetes.io/version: "1.22.0-rc.1"
    app.kubernetes.io/managed-by: Helm
rules:
- nonResourceURLs:
  - /metrics
  - /metrics/slis
  verbs:
  - get
- apiGroups:
  - ""
  resources:
  - componentstatuses
  - deployments
  - limitranges
  - namespaces
  - persistentvolumeclaims
  - persistentvolumes
  - replicationcontrollers
  - resourcequotas
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - configmaps
  - endpoints
  - events
  - pods
  - secrets
  - serviceaccounts
  - services
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - nodes
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - nodes/configz
  - nodes/healthz
  - nodes/logs
  - nodes/metrics
  - nodes/pods
  - nodes/proxy
  - nodes/spec
  - nodes/stats
  verbs:
  - get
- apiGroups:
  - '*'
  resources:
  - '*/scale'
  verbs:
  - get
  - update
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - '*'
- apiGroups:
  - apiextensions.k8s.io
  resources:
  - customresourcedefinitions
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - apiregistration.k8s.io
  resources:
  - apiservices
  verbs:
  - '*'
- apiGroups:
  - apps
  resources:
  - controllerrevisions
  verbs:
  - list
  - watch
- apiGroups:
  - apps
  resources:
  - daemonsets
  - deployments
  verbs:
  - create
  - delete
  - deletecollection
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - apps
  resources:
  - replicasets
  - statefulsets
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - argoproj.io
  resources:
  - rollouts
  verbs:
  - list
  - watch
  - patch
- apiGroups:
  - authentication.k8s.io
  resources:
  - tokenreviews
  verbs:
  - create
  - get
  - list
  - watch
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
  - get
- apiGroups:
  - auto.gke.io
  resources:
  - allowlistsynchronizers
  verbs:
  - create
  - get
  - list
  - watch
- apiGroups:
  - autoscaling
  resources:
  - horizontalpodautoscalers
  verbs:
  - list
  - watch
- apiGroups:
  - autoscaling.k8s.io
  resources:
  - verticalpodautoscalers
  verbs:
  - list
  - watch
- apiGroups:
  - batch
  resources:
  - cronjobs
  - jobs
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - certificates.k8s.io
  resources:
  - certificatesigningrequests
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - cilium.io
  resources:
  - ciliumnetworkpolicies
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - datadoghq.com
  resources:
  - datadogagents
  - datadogagents/finalizers
  - datadoggenericresources
  - datadoggenericresources/finalizers
  - datadogmonitors
  - datadogmonitors/finalizers
  - datadogslos
  - datadogslos/finalizers
  - extendeddaemonsets
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - datadoghq.com
  resources:
  - datadogagents/status
  - datadoggenericresources/status
  - datadogmonitors/status
  - datadogslos/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - datadoghq.com
  resources:
  - datadogmetrics/status
  verbs:
  - update
- apiGroups:
  - datadoghq.com
  resources:
  - datadogmetrics
  verbs:
  - create
  - delete
  - get
  - list
  - watch
- apiGroups:
  - datadoghq.com
  resources:
  - datadogpodautoscalers
  - datadogpodautoscalers/status
  verbs:
  - '*'
- apiGroups:
  - datadoghq.com
  resources:
  - extendeddaemonsetreplicasets
  - watermarkpodautoscalers
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - datadoghq.com
  - karpenter.azure.com
  resources:
  - '*'
  verbs:
  - list
  - watch
- apiGroups:
  - discovery.k8s.io
  resources:
  - endpointslices
  verbs:
  - list
  - watch
- apiGroups:
  - external.metrics.k8s.io
  - karpenter.k8s.aws
  resources:
  - '*'
  verbs:
  - get
  - list
  - watch
- apiGroups:
    - gateway.envoyproxy.io
  resources:
    - envoyextensionpolicies
  verbs:
    - create
    - delete
    - get
- apiGroups:
    - gateway.networking.k8s.io
  resources:
    - gatewayclasses
    - gateways
    - httproutes
  verbs:
    - get
    - list
    - patch
    - watch
- apiGroups:
    - gateway.networking.k8s.io
  resources:
    - referencegrants
  verbs:
    - create
    - delete
    - get
    - patch
- apiGroups:
  - karpenter.sh
  resources:
  - '*'
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - metrics.eks.amazonaws.com
  resources:
  - kcm/metrics
  - ksh/metrics
  verbs:
  - get
- apiGroups:
    - networking.istio.io
  resources:
    - envoyfilters
  verbs:
    - create
    - delete
    - get
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  verbs:
  - get
  - list
  - patch
  - watch
- apiGroups:
  - networking.k8s.io
  resources:
  - networkpolicies
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - policy
  resources:
  - poddisruptionbudgets
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - quota.openshift.io
  resources:
  - clusterresourcequotas
  verbs:
  - get
  - list
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterrolebindings
  - clusterroles
  verbs:
  - create
  - delete
  - deletecollection
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - rolebindings
  - roles
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - security.openshift.io
  resourceNames:
  - restricted
  resources:
  - securitycontextconstraints
  verbs:
  - use
- apiGroups:
  - storage.k8s.io
  resources:
  - storageclasses
  - volumeattachments
  verbs:
  - get
  - list
  - watch
- apiGroups:  # EKS kube_scheduler and kube_controller_manager control plane metrics
  - "metrics.eks.amazonaws.com"
  resources:
  - kcm/metrics
  - ksh/metrics
  verbs:
  - get
---
# Source: datadog/templates/cluster-agent-rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: ClusterRole
metadata:
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: datadog-cluster-agent
rules:
- apiGroups:
  - ""
  resources:
  - services
  - endpoints
  - pods
  - nodes
  - namespaces
  - componentstatuses
  - limitranges
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - get
  - list
  - watch
  - create
- apiGroups:
  - "discovery.k8s.io"
  resources:
  - endpointslices
  verbs:
  - get
  - list
  - watch
- apiGroups: ["quota.openshift.io"]
  resources:
  - clusterresourcequotas
  verbs:
  - get
  - list
- apiGroups:
  - "autoscaling"
  resources:
  - horizontalpodautoscalers
  verbs:
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - configmaps
  resourceNames:
  - datadogtoken  # Kubernetes event collection state
  - datadogtoken  # Kept for backward compatibility with agent <7.37.0
  verbs:
  - get
  - update
- apiGroups:
  - ""
  resources:
  - configmaps
  resourceNames:
  - datadog-leader-election  # Leader election token
  - datadog-leader-election  # Kept for backward compatibility with agent <7.37.0
  verbs:
  - get
  - update
- apiGroups:
  - "coordination.k8s.io"
  resources:
  - leases
  resourceNames:
  - datadog-leader-election  # Leader election token
  verbs:
  - get
  - update
- apiGroups:
  - "coordination.k8s.io"
  resources:
  - leases
  verbs:
  - create
- apiGroups:  # To create the leader election token and hpa events
  - ""
  resources:
  - configmaps
  - events
  verbs:
  - create
- nonResourceURLs:
  - "/version"
  - "/healthz"
  - "/metrics"
  verbs:
  - get
- apiGroups:  # to get the kube-system namespace UID and generate a cluster ID
  - ""
  resources:
  - namespaces
  resourceNames:
  - "kube-system"
  verbs:
  - get
- apiGroups:  # To create the cluster-id configmap
  - ""
  resources:
  - configmaps
  resourceNames:
  - "datadog-cluster-id"
  verbs:
  - create
  - get
  - update
- apiGroups:
  - ""
  resources:
  - persistentvolumes
  - persistentvolumeclaims
  - serviceaccounts
  verbs:
  - list
  - get
  - watch
- apiGroups:
  - "apps"
  resources:
  - deployments
  - replicasets
  - daemonsets
  - statefulsets
  verbs:
  - list
  - get
  - watch
- apiGroups:
  - "batch"
  resources:
  - cronjobs
  - jobs
  verbs:
  - list
  - get
  - watch
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  - networkpolicies
  verbs:
  - list
  - get
  - watch
- apiGroups:
  - "rbac.authorization.k8s.io"
  resources:
  - roles
  - rolebindings
  - clusterroles
  - clusterrolebindings
  verbs:
  - list
  - get
  - watch
- apiGroups:
  - "storage.k8s.io"
  resources:
  - storageclasses
  verbs:
  - list
  - get
  - watch
- apiGroups:
  - autoscaling.k8s.io
  resources:
  - verticalpodautoscalers
  verbs:
  - list
  - get
  - watch
- apiGroups:
    - apiextensions.k8s.io
  resources:
    - customresourcedefinitions
  verbs:
    - list
    - get
    - watch
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - validatingwebhookconfigurations
  - mutatingwebhookconfigurations
  resourceNames:
    - "datadog-webhook"
  verbs: ["get", "list", "watch", "update", "delete"]
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - validatingwebhookconfigurations
  - mutatingwebhookconfigurations
  verbs: ["create"]
- apiGroups: ["batch"]
  resources: ["jobs", "cronjobs"]
  verbs: ["get"]
- apiGroups: ["apps"]
  resources: ["statefulsets", "replicasets", "deployments", "daemonsets"]
  verbs: ["get"]
- apiGroups: [""]
  resources: ["replicationcontrollers"]
  verbs: ["get"]
- apiGroups:
  - "security.openshift.io"
  resources:
  - securitycontextconstraints
  verbs:
  - use
  resourceNames:
  - datadog-cluster-agent
  - hostnetwork
- apiGroups:
  - "policy"
  resources:
  - poddisruptionbudgets
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - "datadoghq.com"
  - karpenter.azure.com
  - karpenter.k8s.aws
  - karpenter.sh
  resources:
  - "*"
  verbs:
  - list
  - watch
- apiGroups:
  - argoproj.io
  resources:
  - rollouts
  verbs:
  - list
  - watch
  - get
# Used by datadog.appsec.injector feature
- apiGroups:
    - "gateway.networking.k8s.io"
  resources:
    - gateways
    - gatewayclasses
  verbs:
    - get
    - list
    - watch
    - patch
- apiGroups:
    - "gateway.networking.k8s.io"
  resources:
    - referencegrants
  verbs:
    - get
    - delete
    - create
    - patch
- apiGroups:
    - "gateway.envoyproxy.io"
  resources:
    - envoyextensionpolicies
  verbs:
    - get
    - delete
    - create
- apiGroups:
    - "networking.istio.io"
  resources:
    - envoyfilters
  verbs:
    - get
    - create
    - delete
---
# Source: datadog/templates/kube-state-metrics-core-rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: ClusterRole
metadata:
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: datadog-ksm-core
rules:
- apiGroups:
  - ""
  resources:
  - secrets
  - configmaps
  - nodes
  - pods
  - services
  - resourcequotas
  - replicationcontrollers
  - limitranges
  - persistentvolumeclaims
  - persistentvolumes
  - namespaces
  - endpoints
  - events
  verbs:
  - list
  - watch
- apiGroups:
  - extensions
  resources:
  - daemonsets
  - deployments
  - replicasets
  verbs:
  - list
  - watch
- apiGroups:
  - apps
  resources:
  - statefulsets
  - daemonsets
  - deployments
  - replicasets
  - controllerrevisions
  verbs:
  - list
  - watch
- apiGroups:
  - batch
  resources:
  - cronjobs
  - jobs
  verbs:
  - list
  - watch
- apiGroups:
  - autoscaling
  resources:
  - horizontalpodautoscalers
  verbs:
  - list
  - watch
- apiGroups:
  - policy
  resources:
  - poddisruptionbudgets
  verbs:
  - list
  - watch
- apiGroups:
  - storage.k8s.io
  resources:
  - storageclasses
  - volumeattachments
  verbs:
  - list
  - watch
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  verbs:
  - list
  - watch
- apiGroups:
    - apiextensions.k8s.io
  resources:
    - customresourcedefinitions
  verbs:
    - list
    - watch
---
# Source: datadog/templates/rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: ClusterRole
metadata:
  name: datadog
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
rules:
- nonResourceURLs:
  - "/metrics"
  - "/metrics/slis"
  verbs:
  - get
- apiGroups:  # Kubelet connectivity
  - ""
  resources:
  - nodes/metrics
  - nodes/spec
  
  - nodes/proxy
  
  - nodes/stats
  verbs:
  - get
- apiGroups:  # leader election check
  - ""
  resources:
  - endpoints
  verbs:
  - get
- apiGroups:
  - "security.openshift.io"
  resources:
  - securitycontextconstraints
  verbs:
  - use
  resourceNames:
  - datadog
  - hostaccess
  - privileged
- apiGroups:  # leader election check
  - "coordination.k8s.io"
  resources:
  - leases
  verbs:
  - get
- apiGroups:  # EKS kube_scheduler and kube_controller_manager control plane metrics
  - "metrics.eks.amazonaws.com"
  resources:
  - kcm/metrics
  - ksh/metrics
  verbs:
  - get
---
# Source: datadog/charts/operator/templates/clusterrole_binding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: datadog-operator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: datadog-operator
subjects:
  - kind: ServiceAccount
    name: datadog-operator
    namespace: default
---
# Source: datadog/templates/cluster-agent-rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: ClusterRoleBinding
metadata:
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: datadog-cluster-agent
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: datadog-cluster-agent
subjects:
  - kind: ServiceAccount
    name: datadog-cluster-agent
    namespace: default
---
# Source: datadog/templates/kube-state-metrics-core-rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: ClusterRoleBinding
metadata:
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: datadog-ksm-core
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: datadog-ksm-core
subjects:
  - kind: ServiceAccount
    name: datadog-cluster-agent
    namespace: default
---
# Source: datadog/templates/rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: ClusterRoleBinding
metadata:
  name: datadog
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: datadog
subjects:
  - kind: ServiceAccount
    name: datadog
    namespace: default
---
# Source: datadog/templates/cluster-agent-rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: Role
metadata:
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: datadog-cluster-agent-main
  namespace: default
rules:
- apiGroups: [""]
  resources: ["secrets"]
  verbs: ["get", "list", "watch", "update", "create"]
---
# Source: datadog/templates/dca-helm-values-rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: Role
metadata:
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: datadog-dca-flare
  namespace: default
rules:
- apiGroups:
  - ""
  resources:
  - secrets
  - configmaps
  verbs:
  - get
  - list
---
# Source: datadog/templates/cluster-agent-rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: RoleBinding
metadata:
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: "datadog-cluster-agent-main"
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: datadog-cluster-agent-main
subjects:
  - kind: ServiceAccount
    name: datadog-cluster-agent
    namespace: default
---
# Source: datadog/templates/dca-helm-values-rbac.yaml
apiVersion: "rbac.authorization.k8s.io/v1"
kind: RoleBinding
metadata:
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
  name: datadog-dca-flare
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: datadog-dca-flare
subjects:
  - kind: ServiceAccount
    name: datadog-cluster-agent
    namespace: default
---
# Source: datadog/templates/agent-services.yaml
apiVersion: v1
kind: Service
metadata:
  name: datadog-cluster-agent
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
spec:
  type: ClusterIP
  selector:
    app: datadog-cluster-agent
  ports:
  - port: 5005
    name: agentport
    protocol: TCP
---
# Source: datadog/templates/agent-services.yaml
apiVersion: v1
kind: Service
metadata:
  name: datadog-cluster-agent-admission-controller
  namespace: default
  labels:
    app: "datadog"
    chart: "datadog-3.160.2"
    release: "datadog"
    heritage: "Helm"
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
spec:
  selector:
    app: datadog-cluster-agent
  ports:
  - port: 443
    targetPort: 8000
    name: datadog-webhook
    protocol: TCP
---
# Source: datadog/templates/agent-services.yaml
apiVersion: v1
kind: Service

metadata:
  name: datadog
  namespace: default
  labels:
    app: "datadog"
    chart: "datadog-3.160.2"
    release: "datadog"
    heritage: "Helm"
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: "datadog"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/version: "7"
spec:
  selector:
    app: datadog
  ports:
    - protocol: UDP
      port: 8125
      targetPort: 8125
      name: dogstatsdport
    - protocol: TCP
      port: 8126
      targetPort: 8126
      name: traceport
  internalTrafficPolicy: Local
---
# Source: datadog/charts/operator/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: datadog-operator
  namespace: default
  labels:
    app.kubernetes.io/name: operator
    helm.sh/chart: operator-2.17.0-dev.2
    app.kubernetes.io/instance: datadog
    app.kubernetes.io/version: "1.22.0-rc.1"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: operator
      app.kubernetes.io/instance: datadog
  template:
    metadata:
      labels:
        app.kubernetes.io/name: operator
        app.kubernetes.io/instance: datadog
      annotations:
        ad.datadoghq.com/operator.check_names: '["openmetrics"]'
        ad.datadoghq.com/operator.init_configs: '[{}]'
        ad.datadoghq.com/operator.instances: |
          [{
            "prometheus_url": "http://%%host%%:8383/metrics",
            "namespace": "datadog.operator",
            "metrics": ["*"]
          }]
    spec:
      serviceAccountName: datadog-operator
      containers:
        - name: operator
          image: "gcr.io/datadoghq/operator:1.21.0"
          imagePullPolicy: IfNotPresent
          env:
            - name: WATCH_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            - name: DD_HOSTNAME
              valueFrom:
                fieldRef:
                  fieldPath: spec.nodeName
            - name: POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: DD_TOOL_VERSION
              value: helm
          args:
            - "-supportExtendedDaemonset=false"
            - "-logEncoder=json"
            - "-metrics-addr=:8383"
            - "-loglevel=info"
            - "-operatorMetricsEnabled=true"
            - "-introspectionEnabled=false"
            - "-datadogAgentProfileEnabled=false"
            - "-datadogMonitorEnabled=false"
            - "-datadogAgentEnabled=false"
            - "-datadogSLOEnabled=true"
            - "-datadogDashboardEnabled=false"
            - "-datadogGenericResourceEnabled=true"
            - "-remoteConfigEnabled=false"
            - "-datadogAgentInternalEnabled=false"
          ports:
            - name: metrics
              containerPort: 8383
              protocol: TCP
          livenessProbe:
            httpGet:
              path: /healthz/
              port: 8081
            initialDelaySeconds: 15
            periodSeconds: 10
          resources:
            {}
          volumeMounts:
      volumes:
---
# Source: datadog/templates/cluster-agent-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: datadog-cluster-agent
  namespace: default
  labels:
    helm.sh/chart: 'datadog-3.160.2'
    app.kubernetes.io/name: "datadog"
    app.kubernetes.io/instance: datadog-cluster-agent
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/part-of: default-datadog
    app.kubernetes.io/version: "7"
    app.kubernetes.io/component: cluster-agent
    agent.datadoghq.com/component: cluster-agent
    
spec:
  replicas: 1
  revisionHistoryLimit: 10
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  selector:
    matchLabels:
      app: datadog-cluster-agent
  template:
    metadata:
      labels:
        
        app.kubernetes.io/name: "datadog"
        app.kubernetes.io/instance: datadog-cluster-agent
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/part-of: default-datadog
        app.kubernetes.io/component: cluster-agent
        admission.datadoghq.com/enabled: "false"
        app: datadog-cluster-agent
        agent.datadoghq.com/component: cluster-agent
        
      name: datadog-cluster-agent
      annotations:
        checksum/clusteragent_token: b37b1c39264b692201212fbfbfbd6b8a895ce4f0e5a38efb6c65795e0749d3b9
        checksum/clusteragent-configmap: d3f1cf47de6403bca193d9214049588a723d852f473cc925aac22528848937f4
        checksum/api_key: 086e620b35e5864b194214134709880d29a58042524140dc0623cbf989658bff
        checksum/application_key: 01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b
        checksum/install_info: 470cf9cc66fc300566fbe7949760d8e8ad4a1de4a0c12403c9696124e68f96df
    spec:
      serviceAccountName: datadog-cluster-agent
      automountServiceAccountToken: true
      initContainers:
      - name: init-volume
        image: "gcr.io/datadoghq/cluster-agent:7.74.0"
        imagePullPolicy: IfNotPresent
        command:
          - cp
          - -r
        args:
          - /etc/datadog-agent
          - /opt
        volumeMounts:
          - name: config
            mountPath: /opt/datadog-agent
      containers:
      - name: cluster-agent
        image: "gcr.io/datadoghq/cluster-agent:7.74.0"
        imagePullPolicy: IfNotPresent
        resources:
          {}
        ports:
        - containerPort: 5005
          name: agentport
          protocol: TCP
        - containerPort: 5000
          name: agentmetrics
          protocol: TCP
        - containerPort: 8000
          name: datadog-webhook
          protocol: TCP
        env:
          - name: DD_POD_NAME
            valueFrom:
              fieldRef:
                fieldPath: metadata.name
          - name: DD_CLUSTER_AGENT_SERVICE_ACCOUNT_NAME
            valueFrom:
              fieldRef:
                fieldPath: spec.serviceAccountName
          - name: DD_HEALTH_PORT
            value: "5556"
          - name: DD_API_KEY
            valueFrom:
              secretKeyRef:
                name: "datadog"
                key: api-key
                optional: true
          
          - name: KUBERNETES
            value: "yes"
          - name: DD_CSI_ENABLED
            value: "false"
          - name: DD_LANGUAGE_DETECTION_ENABLED
            value: "false"
          - name: DD_LANGUAGE_DETECTION_REPORTING_ENABLED
            value: "false"
          - name: DD_ADMISSION_CONTROLLER_ENABLED
            value: "true"
          - name: DD_ADMISSION_CONTROLLER_VALIDATION_ENABLED
            value: "true"
          - name: DD_ADMISSION_CONTROLLER_MUTATION_ENABLED
            value: "true"
          - name: DD_TRACE_AGENT_HOST_SOCKET_PATH
            value: "/var/run/datadog"
          - name: DD_DOGSTATSD_HOST_SOCKET_PATH
            value: "/var/run/datadog"
          - name: DD_DOGSTATSD_SOCKET
            value: "/var/run/datadog/dsd.socket"
          - name: DD_APM_RECEIVER_SOCKET
            value: "/var/run/datadog/apm.socket"
          - name: DD_ADMISSION_CONTROLLER_WEBHOOK_NAME
            value: "datadog-webhook"
          - name: DD_ADMISSION_CONTROLLER_MUTATE_UNLABELLED
            value: "false"
          - name: DD_ADMISSION_CONTROLLER_SERVICE_NAME
            value: datadog-cluster-agent-admission-controller
          - name: DD_ADMISSION_CONTROLLER_INJECT_CONFIG_MODE
            value: socket
          - name: DD_ADMISSION_CONTROLLER_INJECT_CONFIG_LOCAL_SERVICE_NAME
            value: datadog
          - name: DD_ADMISSION_CONTROLLER_FAILURE_POLICY
            value: "Ignore"
          - name: DD_ADMISSION_CONTROLLER_PORT
            value: "8000"
          - name: DD_ADMISSION_CONTROLLER_CONTAINER_REGISTRY
            value: "gcr.io/datadoghq"
          
          
          - name: DD_REMOTE_CONFIGURATION_ENABLED
            value: "false"
          - name: DD_CLUSTER_CHECKS_ENABLED
            value: "true"
          - name: DD_EXTRA_CONFIG_PROVIDERS
            value: "kube_endpoints kube_services"
          - name: DD_EXTRA_LISTENERS
            value: "kube_endpoints kube_services"
          - name: DD_LOG_LEVEL
            value: "INFO"
          - name: DD_LEADER_ELECTION
            value: "true"
          - name: DD_LEADER_ELECTION_DEFAULT_RESOURCE
            value: "configmap"
          - name: DD_LEADER_LEASE_NAME
            value: datadog-leader-election
          - name: DD_CLUSTER_AGENT_TOKEN_NAME
            value: datadogtoken
          - name: DD_COLLECT_KUBERNETES_EVENTS
            value: "true"
          - name: DD_KUBERNETES_USE_ENDPOINT_SLICES
            value: "false"
          - name: DD_KUBERNETES_KUBE_SERVICE_IGNORE_READINESS
            value: "false"
          - name: DD_KUBERNETES_EVENTS_SOURCE_DETECTION_ENABLED
            value: "false"
          - name: DD_CLUSTER_AGENT_KUBERNETES_SERVICE_NAME
            value: datadog-cluster-agent
          - name: DD_CLUSTER_AGENT_AUTH_TOKEN
            valueFrom:
              secretKeyRef:
                name: datadog-cluster-agent
                key: token
          - name: DD_CLUSTER_AGENT_COLLECT_KUBERNETES_TAGS
            value: "false"
          - name: DD_KUBE_RESOURCES_NAMESPACE
            value: default
          - name: CHART_RELEASE_NAME
            value: "datadog"
          - name: AGENT_DAEMONSET
            value: datadog
          - name: CLUSTER_AGENT_DEPLOYMENT
            value: datadog-cluster-agent
          - name: DD_ORCHESTRATOR_EXPLORER_ENABLED
            value: "true"
          - name: DD_ORCHESTRATOR_EXPLORER_CONTAINER_SCRUBBING_ENABLED
            value: "true"
          - name: DD_CLUSTER_AGENT_LANGUAGE_DETECTION_PATCHER_ENABLED
            value: "false"
          - name: DD_INSTRUMENTATION_INSTALL_TIME
            valueFrom:
              configMapKeyRef:
                name: datadog-kpi-telemetry-configmap
                key: install_time
          - name: DD_INSTRUMENTATION_INSTALL_ID
            valueFrom:
              configMapKeyRef:
                name: datadog-kpi-telemetry-configmap
                key: install_id
          - name: DD_INSTRUMENTATION_INSTALL_TYPE
            valueFrom:
              configMapKeyRef:
                name: datadog-kpi-telemetry-configmap
                key: install_type
                              
        livenessProbe:
          failureThreshold: 6
          httpGet:
            path: /live
            port: 5556
            scheme: HTTP
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 5
        readinessProbe:
          failureThreshold: 6
          httpGet:
            path: /ready
            port: 5556
            scheme: HTTP
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 5
        startupProbe:
          failureThreshold: 6
          httpGet:
            path: /startup
            port: 5556
            scheme: HTTP
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 5
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
        volumeMounts:
          - name: datadogrun
            mountPath: /opt/datadog-agent/run
            readOnly: false
          - name: varlog
            mountPath: /var/log/datadog
            readOnly: false
          - name: tmpdir
            mountPath: /tmp
            readOnly: false
          - name: installinfo
            subPath: install_info
            mountPath: /etc/datadog-agent/install_info
            readOnly: true
          - name: confd
            mountPath: /conf.d
            readOnly: true
          - name: config
            mountPath: /etc/datadog-agent
      volumes:
        - name: datadogrun
          emptyDir: {}
        - name: varlog
          emptyDir: {}
        - name: tmpdir
          emptyDir: {}
        - name: installinfo
          configMap:
            name: datadog-installinfo
        - name: confd
          configMap:
            name: datadog-cluster-agent-confd
            items:
            - key: kubernetes_state_core.yaml.default
              path: kubernetes_state_core.d/kubernetes_state_core.yaml.default
            - key: kubernetes_apiserver.yaml
              path: kubernetes_apiserver.d/kubernetes_apiserver.yaml
        - name: config
          emptyDir: {}
      affinity:
        # Prefer scheduling the cluster agents on different nodes
        # to guarantee that the standby instance can immediately take the lead from a leader running of a faulty node.
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 50
            podAffinityTerm:
              labelSelector:
                matchLabels:
                  app: datadog-cluster-agent
              topologyKey: kubernetes.io/hostname
      nodeSelector:
        kubernetes.io/os: linux

